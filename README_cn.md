
# 基于BERT的集成情感分析以增强混合推荐系统

本代码仓库包含在混合推荐系统框架内使用BERT进行情感分析的实现代码。该代码展示了如何将情感分析与协同过滤技术相结合，以提升不同业务类型的推荐质量。

## 项目概述

本项目实现了一个混合推荐系统，该系统结合了以下技术：
- 基于BERT的情感分析
- 深度矩阵分解
- 词嵌入聚类
- 非负矩阵分解（NMF）
- 决策树回归

系统处理Yelp评论数据，生成餐厅和酒店的推荐，同时考虑用户评分和从评论文本中提取的情感分数。

## 数据集

实现中使用了Yelp数据集（`yelp_training_set_flattened.csv`），其中包含企业评论，主要字段如下：
- `review_id`：每条评论的唯一标识符
- `business_id`：被评论企业的标识符
- `text`：评论文本内容
- `stars`：用户评分（1-5星）
- `business_categories`：描述企业的类别

## 实现细节

### 1. 数据预处理
- 加载并检查Yelp数据集
- 文本预处理流程包括：
  - 分词
  - 词性标注
  - 停用词去除
  - 词形还原
- 企业类型分类（餐厅/酒店/其他）

### 2. 情感分析
- 使用BERT模型（`nlptown/bert-base-multilingual-uncased-sentiment`）进行情感分类
- 处理预处理后的评论文本以生成情感分数
- 将情感分数作为特征集成到推荐系统中

### 3. 深度矩阵分解
- 基于神经网络的协同过滤
- 用户和项目嵌入层（维度=8）
- 密集层（32 → 16 → 1）以捕捉非线性交互
- 分别针对餐厅和酒店数据子集进行训练

### 4. 聚类分析
- 评论文本的Word2Vec嵌入（向量大小=100）
- 文本向量与情感分数的特征组合
- 使用PCA进行降维
- K-means聚类以对相似评论进行分组

### 5. 混合特征生成
- 使用非负矩阵分解（NMF）创建潜在特征
- 结合协同过滤预测、情感分数和聚类分配

### 6. 评分预测
- 使用决策树回归器进行最终评分预测
- 使用均方根误差（RMSE）进行性能评估
- 针对餐厅和酒店推荐分别建立模型

## 依赖项

实现需要以下库：
- pandas
- nltk
- torch
- transformers
- tensorflow
- numpy
- gensim
- scikit-learn

## 使用方法

代码设计为在Google Colab中运行，数据集存储在Google Drive中。主要工作流程如下：
1. 挂载Google Drive并加载数据集
2. 预处理评论文本
3. 使用BERT提取情感分数
4. 按企业类型（餐厅/酒店）划分数据
5. 训练深度矩阵分解模型
6. 基于文本和情感生成聚类
7. 使用NMF创建混合特征
8. 训练并评估决策树回归器

## 结果

系统为餐厅和酒店生成独立的推荐模型，并为每个领域提供RMSE分数。情感分析与协同过滤的集成展示了自然语言理解如何增强传统推荐方法。